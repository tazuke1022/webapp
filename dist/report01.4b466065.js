function e(e,t,s,a){Object.defineProperty(e,t,{get:s,set:a,enumerable:!0,configurable:!0})}var t=globalThis,s={},a={},l=t.parcelRequire49ed;null==l&&((l=function(e){if(e in s)return s[e].exports;if(e in a){var t=a[e];delete a[e];var l={id:e,exports:{}};return s[e]=l,t.call(l.exports,l,l.exports),l.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){a[e]=t},t.parcelRequire49ed=l),(0,l.register)("brsYM",function(t,s){e(t.exports,"LoginContext",()=>n),e(t.exports,"Authenticate",()=>o);var a=l("c54Ow"),r=l("lbJE2");let n=(0,r.createContext)(),o=e=>{let t=e.usernameSaveKey?`${document.location.pathname}#Authenticate${e.usernameSaveKey}`:void 0,s=t?localStorage.getItem(t):null,[l,o]=(0,r.useState)(void 0!==e.username?e.username:s),i=(0,r.useRef)(""),[c,d]=(0,r.useState)(""),[u,h]=(0,r.useState)(null),p=async()=>{try{d("");let e=await fetch("/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l,password:i.current.value})});if(!e.ok){if(403===e.status)throw Error("ログイン・エラー");throw Error(`${e.status} ${e.statusText}`)}let s=await e.json();h(s),void 0!==t&&localStorage.setItem(t,l)}catch(e){d(e.message),h(null),void 0!==t&&localStorage.removeItem(t)}};return(0,r.useEffect)(()=>{if(void 0!==e.username&&void 0!==e.password)i.current.value=e.password,p();else if(void 0!==t){let e=localStorage.getItem(t);null!==e&&(i.current.value=e,o(e))}},[]),u?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"authenticate-logout",children:[(0,a.jsxs)("span",{children:["User: ",u?u.username:""]}),void 0!==e.username&&void 0!==e.password?null:(0,a.jsx)("button",{type:"button",onClick:()=>{h(null),void 0!==t&&localStorage.removeItem(t)},children:"ログアウト"})]}),(0,a.jsx)(n.Provider,{value:u,children:e.children})]}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"authenticate-login",children:[(0,a.jsxs)("label",{children:[(0,a.jsx)("span",{children:"ユーザ名:"}),(0,a.jsx)("span",{children:(0,a.jsx)("input",{type:"text",placeholder:"ユーザ名",onChange:e=>o(e.target.value),value:l})})]}),(0,a.jsxs)("label",{children:[(0,a.jsx)("span",{children:"パスワード:"}),(0,a.jsx)("span",{children:(0,a.jsx)("input",{type:"password",ref:i,placeholder:"パスワード",defaultValue:""})})]}),(0,a.jsx)("button",{type:"button",onClick:p,children:"ログイン"})]}),(0,a.jsx)("div",{children:""===c?null:(0,a.jsx)("div",{className:"error-message",onClick:()=>d(""),children:c})})]})}});var r=l("c54Ow"),n=l("eKYsq"),o=l("aFIWk"),r=l("c54Ow"),i=l("lbJE2"),c=l("brsYM"),i=l("lbJE2");const d=(e,t)=>{let s=localStorage.getItem(e),[a,l]=(0,i.useState)(null===s?"function"==typeof t?t():t:JSON.parse(s));return(0,i.useEffect)(()=>{localStorage.setItem(e,JSON.stringify(a))},[a]),[a,l]},u=new Date,h=u.getFullYear(),p=u.getMonth()+1,x=u.getDate(),m=`${h.toString()}-${p.toString().padStart(2,"0")}-${x.toString().padStart(2,"0")}`;var c=l("brsYM");(0,n.createRoot)(document.getElementById("root")).render((0,r.jsxs)(o.ErrorBoundary,{children:[(0,r.jsx)("p",{children:"ログイン"}),(0,r.jsx)(c.Authenticate,{usernameSaveKey:"key1",children:(0,r.jsx)(e=>{let[t,s]=(0,i.useState)([]),[a,l]=(0,i.useState)(""),[n,o]=(0,i.useState)(""),u=(0,i.useContext)(c.LoginContext),h=u?{Authorization:"Bearer "+u.token}:{},p=(0,i.useRef)(null),x=(0,i.useRef)(null),[j,g]=d(`${document.location.pathname}#ToDoList${e.url}-showCompleted`,!0),[v,y]=d(`${document.location.pathname}#ToDoList${e.url}-sortTaskList`,!1),[f,S]=(0,i.useState)(null),[b,k]=(0,i.useState)(["仕事","個人","その他"]),[C,N]=(0,i.useState)("");(0,i.useEffect)(()=>{let t=`${document.location.pathname}#ToDoList${e.url}-showCompleted`;localStorage.setItem(t,JSON.stringify(j))},[j]),(0,i.useEffect)(()=>{w()},[]);let w=async()=>{try{l("");let t=await fetch(e.url,{method:"GET",headers:h});if(!t.ok)throw Error(`${t.status} ${t.statusText}`);let a=await t.json();s(a)}catch(e){l(e.message)}},E=async()=>{let t=p.current.value,s=x.current.value;try{l("");let a=await fetch(e.url,{method:"POST",headers:{"Content-Type":"application/json",...h},body:JSON.stringify({description:n,completed:!1,...u?{username:u.username}:{},...t?{deadline:t}:{},priority:s,category:C})});if(!a.ok)throw Error(`${a.status} ${a.statusText}`);o(""),p.current.value="",x.current.value="0",w()}catch(e){l(e.message)}},$=async t=>{try{l("");let s=await fetch(e.url+"/"+t._id,{method:"PUT",headers:{"Content-Type":"application/json",...h},body:JSON.stringify(t)});if(!s.ok)throw Error(`${s.status} ${s.statusText}`);w(),S(null)}catch(e){l(e.message)}},T=async t=>{try{l("");let s=await fetch(e.url+"/"+t._id,{method:"DELETE",headers:h});if(!s.ok)throw Error(`${s.status} ${s.statusText}`);w()}catch(e){l(e.message)}},O=e=>!e.completed&&e.deadline&&e.deadline<m,I=t.filter(e=>j||!e.completed),D=v?I.sort((e,t)=>{if(e.completed!==t.completed)return e.completed?1:-1;{let s=e.deadline?e.deadline:"9",a=t.deadline?t.deadline:"9";return s!==a?s<a?-1:1:e.priority===t.priority?e._id<t._id?-1:1:e.priority>t.priority?-1:1}}):I;return(0,r.jsxs)("div",{className:"todo-list",children:[(0,r.jsxs)("div",{className:"todo-list-head",children:[(0,r.jsxs)("span",{onClick:w,children:["ToDoリスト",e.url]}),(0,r.jsxs)("label",{children:[(0,r.jsx)("input",{type:"checkbox",checked:j,onChange:e=>{g(e.target.checked)}}),"完了済のタスクも表示"]}),(0,r.jsxs)("label",{children:[(0,r.jsx)("input",{type:"checkbox",checked:v,onChange:e=>{y(e.target.checked)}}),"並べ替え"]})]}),0===D.length?null:(0,r.jsx)("div",{className:"todo-list-task-list",children:D.map(e=>(0,r.jsx)("div",{className:"todo-list-task"+(e.completed?" todo-list-completed":"")+(O(e)?" todo-list-overdue":""),children:f&&f._id===e._id?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"text",value:f.description,onChange:e=>S({...f,description:e.target.value})}),(0,r.jsxs)("select",{value:f.priority||"0",onChange:e=>S({...f,priority:e.target.value}),children:[(0,r.jsx)("option",{value:"3",children:"★★★"}),(0,r.jsx)("option",{value:"2",children:"★★☆"}),(0,r.jsx)("option",{value:"1",children:"★☆☆"}),(0,r.jsx)("option",{value:"0",children:"☆☆☆"})]}),(0,r.jsx)("input",{className:"todo-list-deadline",type:"date",value:f.deadline||"",onChange:e=>S({...f,deadline:e.target.value})}),(0,r.jsxs)("select",{value:f.category,onChange:e=>S({...f,category:e.target.value}),children:[(0,r.jsx)("option",{value:"仕事",children:"仕事"}),(0,r.jsx)("option",{value:"個人",children:"個人"}),(0,r.jsx)("option",{value:"その他",children:"その他"})]}),(0,r.jsx)("button",{onClick:()=>$(f),children:"保存"}),(0,r.jsx)("button",{onClick:()=>S(null),children:"キャンセル"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"checkbox",checked:e.completed,onChange:t=>$({...e,completed:t.target.checked})}),(0,r.jsx)("span",{className:"todo-list-description",children:e.description}),(0,r.jsx)("span",{className:"todo-list-priority",children:["☆☆☆","★☆☆","★★☆","★★★"][e.priority]}),(0,r.jsx)("span",{className:"todo-list-deadline",children:e.deadline}),(0,r.jsxs)("span",{className:"todo-list-username",children:["【",e.username,"】"]}),(0,r.jsxs)("span",{className:"todo-list-category",children:["個人"===e.category?(0,r.jsx)("span",{className:"circle-blue",children:" "}):"仕事"===e.category?(0,r.jsx)("span",{className:"circle-orange",children:" "}):(0,r.jsx)("span",{className:"circle-purple",children:" "}),e.category]}),(0,r.jsx)("button",{onClick:()=>S(e),children:"編集"}),(0,r.jsx)("button",{onClick:()=>T(e),children:"削除"})]})},e._id))}),(0,r.jsxs)("div",{className:"todo-list-task-input",children:[(0,r.jsx)("input",{type:"text",onChange:e=>{o(e.target.value)},placeholder:"タスク",value:n}),(0,r.jsxs)("select",{defaultValue:"0",ref:x,children:[(0,r.jsx)("option",{value:"3",children:"★★★"}),(0,r.jsx)("option",{value:"2",children:"★★☆"}),(0,r.jsx)("option",{value:"1",children:"★☆☆"}),(0,r.jsx)("option",{value:"0",children:"☆☆☆"})]}),(0,r.jsxs)("select",{value:C,onChange:e=>N(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"カテゴリーを選択"}),b.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),(0,r.jsx)("input",{type:"date",ref:p,defaultValue:""}),(0,r.jsx)("button",{type:"button",onClick:E,children:"追加"})]}),""===a?null:(0,r.jsx)("div",{className:"error-message",onClick:()=>l(""),children:a})]})},{url:"/todo-secure"})}),(0,r.jsx)("hr",{})]}));
//# sourceMappingURL=report01.4b466065.js.map
